{"version":3,"sources":["../../app/helpers/receiver.js"],"names":["module","exports","AmqpReceiver","constructor","register","service_name","process","env","npm_package_name","receive_from","payload_name","amqp","_init","Error","create","update","delete","receiveCreate","receiveUpdate","receiveDelete","callback","value","console","log","actions","receive"],"mappings":"AAAA;;AAEAA,OAAOC,OAAP,GAAiB,MAAMC,YAAN,CAAmB;AAChCC,kBAAa;AACT,aAAKC,QAAL;AACA,aAAKC,YAAL,GAAoBC,QAAQC,GAAR,CAAYC,gBAAhC;AACH;;AAEDJ,eAAU;AACN,aAAKK,YAAL,GAAoB,EAApB;AACA,aAAKC,YAAL,GAAoB,EAApB;AACA,aAAKC,IAAL,GAAY,IAAZ;AACH;;AAEDC,UAAMD,IAAN,EAAW;AACP,YAAG,CAACA,IAAJ,EAAS;AACL,kBAAM,IAAIE,KAAJ,CAAU,qBAAV,CAAN;AACH;AACD,aAAKF,IAAL,GAAYA,IAAZ;AACA,aAAKG,MAAL;AACA,aAAKC,MAAL;AACA,aAAKC,MAAL;AACH;;AAEDF,aAAQ;AACJ,aAAKG,aAAL;AACH;;AAEDF,aAAQ;AACJ,aAAKG,aAAL;AACH;;AAEDF,aAAQ;AACJ,aAAKG,aAAL;AACH;;AAEDF,kBAAcG,QAAd,EAAuB;AACnB,YAAG,CAACA,QAAJ,EAAa;AACTA,uBAAWC,SAAO;AAACC,wBAAQC,GAAR,CAAYF,KAAZ,EAAmB,WAAnB;AAAgC,aAAnD;AACH;AACD,aAAKV,IAAL,CAAUa,OAAV,CAAkBC,OAAlB,CAA2B,UAAS,KAAKf,YAAa,SAAQ,KAAKD,YAAa,QAAO,KAAKJ,YAAa,EAAzG,EAA4Ge,QAA5G;AACH;;AAEDF,kBAAcE,QAAd,EAAuB;AACnB,YAAG,CAACA,QAAJ,EAAa;AACTA,uBAAWC,SAAO;AAACC,wBAAQC,GAAR,CAAYF,KAAZ,EAAmB,WAAnB;AAAgC,aAAnD;AACH;AACD,aAAKV,IAAL,CAAUa,OAAV,CAAkBC,OAAlB,CAA2B,UAAS,KAAKf,YAAa,SAAQ,KAAKD,YAAa,QAAO,KAAKJ,YAAa,EAAzG,EAA4Ge,QAA5G;AACH;;AAEDD,kBAAcC,QAAd,EAAuB;AACnB,YAAG,CAACA,QAAJ,EAAa;AACTA,uBAAWC,SAAO;AAACC,wBAAQC,GAAR,CAAYF,KAAZ,EAAmB,WAAnB;AAAgC,aAAnD;AACH;AACD,aAAKV,IAAL,CAAUa,OAAV,CAAkBC,OAAlB,CAA2B,UAAS,KAAKf,YAAa,SAAQ,KAAKD,YAAa,QAAO,KAAKJ,YAAa,EAAzG,EAA4Ge,QAA5G;AACH;AArD+B,CAApC","file":"receiver.js","sourcesContent":["'use strict';\r\n\r\nmodule.exports = class AmqpReceiver {\r\n    constructor(){\r\n        this.register();\r\n        this.service_name = process.env.npm_package_name\r\n    }\r\n\r\n    register(){\r\n        this.receive_from = '';\r\n        this.payload_name = '';\r\n        this.amqp = null;\r\n    }\r\n\r\n    _init(amqp){\r\n        if(!amqp){\r\n            throw new Error('amqp is not defined')\r\n        }\r\n        this.amqp = amqp;\r\n        this.create();\r\n        this.update();\r\n        this.delete();\r\n    }\r\n\r\n    create(){\r\n        this.receiveCreate();\r\n    }\r\n\r\n    update(){\r\n        this.receiveUpdate();\r\n    }\r\n\r\n    delete(){\r\n        this.receiveDelete();\r\n    }\r\n\r\n    receiveCreate(callback){\r\n        if(!callback){\r\n            callback = value=>{console.log(value, 'on_create')};\r\n        }\r\n        this.amqp.actions.receive(`create_${this.payload_name}_from_${this.receive_from}_for_${this.service_name}`, callback)\r\n    }\r\n\r\n    receiveUpdate(callback){\r\n        if(!callback){\r\n            callback = value=>{console.log(value, 'on_update')};\r\n        }\r\n        this.amqp.actions.receive(`update_${this.payload_name}_from_${this.receive_from}_for_${this.service_name}`, callback)\r\n    }\r\n\r\n    receiveDelete(callback){\r\n        if(!callback){\r\n            callback = value=>{console.log(value, 'on_delete')};\r\n        }\r\n        this.amqp.actions.receive(`delete_${this.payload_name}_from_${this.receive_from}_for_${this.service_name}`, callback)\r\n    }\r\n}"]}